\hypertarget{autosave_2plugin_8js}{\section{src/\+Acme\+Group/\+Labo\+Bundle/\+Resources/public/js/tinymce/plugins/autosave/plugin.js File Reference}
\label{autosave_2plugin_8js}\index{src/\+Acme\+Group/\+Labo\+Bundle/\+Resources/public/js/tinymce/plugins/autosave/plugin.\+js@{src/\+Acme\+Group/\+Labo\+Bundle/\+Resources/public/js/tinymce/plugins/autosave/plugin.\+js}}
}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{legacyoutput_2plugin_8min_8js_a9e0c63e13122add16db57b355b91bbc8}{tinymce} Plugin\+Manager \hyperlink{autosave_2plugin_8js_a9437e6ab28adfb3395b50686ac9f364b}{add} ('autosave', function(editor)\{var \hyperlink{jquery_8tooltip_8js_a52fb9116a07f71570fbf0bd12ff4c9f8}{settings}=\hyperlink{jquery_8tooltip_8js_a52fb9116a07f71570fbf0bd12ff4c9f8}{editor.\+settings}, Local\+Storage=tinymce.\+util.\+Local\+Storage, prefix, started;prefix=settings.\+autosave\+\_\+prefix$\vert$$\vert$ '\hyperlink{legacyoutput_2plugin_8min_8js_a9e0c63e13122add16db57b355b91bbc8}{tinymce}-\/autosave-\/\{\hyperlink{jquery_8mobile-1_83_81_8js_a85880b4fcfb12e8240a306187313f0b4}{path}\}\{query\}-\/\{id\}-\/';prefix=prefix.\+replace(/\textbackslash{}\{path\textbackslash{}\}/\hyperlink{fullpage_2plugin_8min_8js_a103df269476e78897c9c4c6cb8f4eb06}{g}, document.\+location.\+pathname);prefix=prefix.\+replace(/\textbackslash{}\{query\textbackslash{}\}/\hyperlink{fullpage_2plugin_8min_8js_a103df269476e78897c9c4c6cb8f4eb06}{g}, document.\+location.\+search);prefix=prefix.\+replace(/\textbackslash{}\{id\textbackslash{}\}/\hyperlink{fullpage_2plugin_8min_8js_a103df269476e78897c9c4c6cb8f4eb06}{g}, editor.\+id);function parse\+Time(time, default\+Time)\{var multipels=\{s\+:1000, m\+:60000\};time=/$^\wedge$(\textbackslash{}\hyperlink{fullpage_2plugin_8min_8js_a86138ad7596633fd5f960ad9c40f8862}{d}+)(\mbox{[}ms\mbox{]}?)\$/.exec(''+(time$\vert$$\vert$default\+Time));return(time\mbox{[}2\mbox{]}?multipels\mbox{[}time\mbox{[}2\mbox{]}\mbox{]}\+:1)$\ast$parse\+Int(time, 10);\}function has\+Draft()\{var time=parse\+Int(Local\+Storage.\+get\+Item(prefix+\char`\"{}time\char`\"{}), 10)$\vert$$\vert$0;if(new Date().get\+Time()-\/time $>$ settings.\+autosave\+\_\+retention)\{remove\+Draft(\hyperlink{validate_8js_a5df37b7f02e5cdc7d9412b7f872b8e01}{false});return \hyperlink{validate_8js_a5df37b7f02e5cdc7d9412b7f872b8e01}{false};\}return true;\}function remove\+Draft(\hyperlink{_format_controls_8js_acd7a0915b5228909cee16d24a676911c}{fire})\{Local\+Storage.\+remove\+Item(prefix+\char`\"{}draft\char`\"{});Local\+Storage.\+remove\+Item(prefix+\char`\"{}time\char`\"{});if(fire!==\hyperlink{validate_8js_a5df37b7f02e5cdc7d9412b7f872b8e01}{false})\{\hyperlink{_format_controls_8js_acd7a0915b5228909cee16d24a676911c}{editor.\+fire}('Remove\+Draft');\}\}function store\+Draft()\{\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(!is\+Empty())\{Local\+Storage.\+set\+Item(prefix+\char`\"{}draft\char`\"{}, editor.\+get\+Content(\{format\+: 'raw', no\+\_\+events\+:true\}));Local\+Storage.\+set\+Item(prefix+\char`\"{}time\char`\"{}, new Date().get\+Time());\hyperlink{_format_controls_8js_acd7a0915b5228909cee16d24a676911c}{editor.\+fire}('Store\+Draft');\}\}function restore\+Draft()\{\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(has\+Draft())\{\hyperlink{fullpage_2plugin_8js_a465938ea1cd397f0d555ca5c6a621f56}{editor.\+set\+Content}(Local\+Storage.\+get\+Item(prefix+\char`\"{}draft\char`\"{}),\{format\+: 'raw'\});\hyperlink{_format_controls_8js_acd7a0915b5228909cee16d24a676911c}{editor.\+fire}('Restore\+Draft');\}\}function start\+Store\+Draft()\{\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(!started)\{set\+Interval(function()\{\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(!editor.\+removed)\{store\+Draft();\}\}, settings.\+autosave\+\_\+interval);started=true;\}\}settings.\+autosave\+\_\+interval=parse\+Time(settings.\+autosave\+\_\+interval, '30s');settings.\+autosave\+\_\+retention=parse\+Time(settings.\+autosave\+\_\+retention, '20m');function post\+Render()\{var self=this;self.\+disabled(!has\+Draft());editor.\+on('\+Store\+Draft Restore\+Draft Remove\+Draft', function()\{self.\+disabled(!has\+Draft());\});start\+Store\+Draft();\}function restore\+Last\+Draft()\{editor.\+undo\+Manager.\+before\+Change();restore\+Draft();remove\+Draft();editor.\+undo\+Manager.\+add();\}editor.\+add\+Button('restoredraft',\{title\+: '\+Restore last draft', onclick\+:restore\+Last\+Draft, on\+Post\+Render\+:post\+Render\});editor.\+add\+Menu\+Item('restoredraft',\{text\+: '\+Restore last draft', onclick\+:restore\+Last\+Draft, on\+Post\+Render\+:post\+Render, context\+: 'file'\});function before\+Unload\+Handler()\{var msg;tinymce.\+each(tinymce.\+editors, function(editor)\{if(editor.\+plugins.\+autosave)\{editor.\+plugins.\+autosave.\+store\+Draft();\}if(!msg \&\&editor.\+is\+Dirty()\&\&editor.\+get\+Param(\char`\"{}autosave\+\_\+ask\+\_\+before\+\_\+unload\char`\"{}, true))\{msg=editor.\+translate(\char`\"{}\+You have unsaved changes are you sure you want to navigate away?\char`\"{});\}\});return msg;\}function is\+Empty(html)\{var forced\+Root\+Block\+Name=editor.\+settings.\+forced\+\_\+root\+\_\+block;html=tinymce.\+trim(typeof(html)==\char`\"{}undefined\char`\"{}?editor.\+get\+Body().\+inner\+H\+T\+M\+L\+:html);return html=== ''$\vert$$\vert$new Reg\+Exp('$^\wedge$$<$'+forced\+Root\+Block\+Name+ '\mbox{[}$^\wedge$$>$\mbox{]}$\ast$ $>$((\textbackslash{}u00a0$\vert$\&nbsp;$\vert$\mbox{[}\textbackslash{}t\mbox{]}$\vert$$<$ br\mbox{[}$^\wedge$$>$\mbox{]}$\ast$ $>$)+?$\vert$)$<$\textbackslash{}/'+forced\+Root\+Block\+Name+ '$>$$\vert$$<$ br $>$ \$', 'i').\+test(html);\}if(editor.\+settings.\+autosave\+\_\+restore\+\_\+when\+\_\+empty!==false)\{editor.\+on('init', function()\{if(has\+Draft()\&\&is\+Empty())\{restore\+Draft();\}\});editor.\+on('save\+Content', function()\{remove\+Draft();\});\}window.\+onbeforeunload=before\+Unload\+Handler;this.\+has\+Draft=has\+Draft;this.\+store\+Draft=store\+Draft;this.\+restore\+Draft=restore\+Draft;this.\+remove\+Draft=remove\+Draft;this.\+is\+Empty=is\+Empty;\})
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{autosave_2plugin_8js_a9437e6ab28adfb3395b50686ac9f364b}{\index{autosave/plugin.\+js@{autosave/plugin.\+js}!add@{add}}
\index{add@{add}!autosave/plugin.\+js@{autosave/plugin.\+js}}
\subsubsection[{add}]{\setlength{\rightskip}{0pt plus 5cm}{\bf tinymce} Plugin\+Manager add (
\begin{DoxyParamCaption}
\item[{'autosave'}]{, }
\item[{function(editor)\{var {\bf settings}={\bf editor.\+settings}, Local\+Storage=tinymce.\+util.\+Local\+Storage, prefix, started;prefix=settings.\+autosave\+\_\+prefix$\vert$$\vert$ '{\bf tinymce}-\/autosave-\/\{{\bf path}\}\{query\}-\/\{id\}-\/';prefix=prefix.\+replace(/\textbackslash{}\{path\textbackslash{}\}/{\bf g}, document.\+location.\+pathname);prefix=prefix.\+replace(/\textbackslash{}\{query\textbackslash{}\}/{\bf g}, document.\+location.\+search);prefix=prefix.\+replace(/\textbackslash{}\{id\textbackslash{}\}/{\bf g}, editor.\+id);function parse\+Time(time, default\+Time)\{var multipels=\{s\+:1000, m\+:60000\};time=/$^\wedge$(\textbackslash{}{\bf d}+)(\mbox{[}ms\mbox{]}?)\$/.exec(''+(time$\vert$$\vert$default\+Time));return(time\mbox{[}2\mbox{]}?multipels\mbox{[}time\mbox{[}2\mbox{]}\mbox{]}\+:1)$\ast$parse\+Int(time, 10);\}function has\+Draft()\{var time=parse\+Int(Local\+Storage.\+get\+Item(prefix+\char`\"{}time\char`\"{}), 10)$\vert$$\vert$0;if(new Date().get\+Time()-\/time $>$ settings.\+autosave\+\_\+retention)\{remove\+Draft({\bf false});return {\bf false};\}return true;\}function remove\+Draft({\bf fire})\{Local\+Storage.\+remove\+Item(prefix+\char`\"{}draft\char`\"{});Local\+Storage.\+remove\+Item(prefix+\char`\"{}time\char`\"{});if(fire!=={\bf false})\{{\bf editor.\+fire}('Remove\+Draft');\}\}function store\+Draft()\{{\bf if}(!is\+Empty())\{Local\+Storage.\+set\+Item(prefix+\char`\"{}draft\char`\"{}, editor.\+get\+Content(\{format\+: 'raw', no\+\_\+events\+:true\}));Local\+Storage.\+set\+Item(prefix+\char`\"{}time\char`\"{}, new Date().get\+Time());{\bf editor.\+fire}('Store\+Draft');\}\}function restore\+Draft()\{{\bf if}(has\+Draft())\{{\bf editor.\+set\+Content}(Local\+Storage.\+get\+Item(prefix+\char`\"{}draft\char`\"{}),\{format\+: 'raw'\});{\bf editor.\+fire}('Restore\+Draft');\}\}function start\+Store\+Draft()\{{\bf if}(!started)\{set\+Interval(function()\{{\bf if}(!editor.\+removed)\{store\+Draft();\}\}, settings.\+autosave\+\_\+interval);started=true;\}\}settings.\+autosave\+\_\+interval=parse\+Time(settings.\+autosave\+\_\+interval, '30s');settings.\+autosave\+\_\+retention=parse\+Time(settings.\+autosave\+\_\+retention, '20m');function post\+Render()\{var self=this;self.\+disabled(!has\+Draft());editor.\+on('\+Store\+Draft Restore\+Draft Remove\+Draft', function()\{self.\+disabled(!has\+Draft());\});start\+Store\+Draft();\}function restore\+Last\+Draft()\{editor.\+undo\+Manager.\+before\+Change();restore\+Draft();remove\+Draft();editor.\+undo\+Manager.\+add();\}editor.\+add\+Button('restoredraft',\{title\+: '\+Restore last draft', onclick\+:restore\+Last\+Draft, on\+Post\+Render\+:post\+Render\});editor.\+add\+Menu\+Item('restoredraft',\{text\+: '\+Restore last draft', onclick\+:restore\+Last\+Draft, on\+Post\+Render\+:post\+Render, context\+: 'file'\});function before\+Unload\+Handler()\{var msg;tinymce.\+each(tinymce.\+editors, function(editor)\{if(editor.\+plugins.\+autosave)\{editor.\+plugins.\+autosave.\+store\+Draft();\}if(!msg \&\&editor.\+is\+Dirty()\&\&editor.\+get\+Param(\char`\"{}autosave\+\_\+ask\+\_\+before\+\_\+unload\char`\"{}, true))\{msg=editor.\+translate(\char`\"{}\+You have unsaved changes are you sure you want to navigate away?\char`\"{});\}\});return msg;\}function is\+Empty(html)\{var forced\+Root\+Block\+Name=editor.\+settings.\+forced\+\_\+root\+\_\+block;html=tinymce.\+trim(typeof(html)==\char`\"{}undefined\char`\"{}?editor.\+get\+Body().\+inner\+H\+T\+M\+L\+:html);return html=== ''$\vert$$\vert$new Reg\+Exp('$^\wedge$$<$'+forced\+Root\+Block\+Name+ '\mbox{[}$^\wedge$$>$\mbox{]}$\ast$ $>$((\textbackslash{}u00a0$\vert$\&nbsp;$\vert$\mbox{[}\textbackslash{}t\mbox{]}$\vert$$<$ br\mbox{[}$^\wedge$$>$\mbox{]}$\ast$ $>$)+?$\vert$)$<$\textbackslash{}/'+forced\+Root\+Block\+Name+ '$>$$\vert$$<$ br $>$ \$', 'i').\+test(html);\}if(editor.\+settings.\+autosave\+\_\+restore\+\_\+when\+\_\+empty!==false)\{editor.\+on('init', function()\{if(has\+Draft()\&\&is\+Empty())\{restore\+Draft();\}\});editor.\+on('save\+Content', function()\{remove\+Draft();\});\}window.\+onbeforeunload=before\+Unload\+Handler;this.\+has\+Draft=has\+Draft;this.\+store\+Draft=store\+Draft;this.\+restore\+Draft=restore\+Draft;this.\+remove\+Draft=remove\+Draft;this.\+is\+Empty=is\+Empty;\}}]{}
\end{DoxyParamCaption}
)}}\label{autosave_2plugin_8js_a9437e6ab28adfb3395b50686ac9f364b}
plugin.\+js

Copyright, Moxiecode Systems A\+B Released under L\+G\+P\+L License.

License\+: \href{http://www.tinymce.com/license}{\tt http\+://www.\+tinymce.\+com/license} Contributing\+: \href{http://www.tinymce.com/contributing}{\tt http\+://www.\+tinymce.\+com/contributing} 