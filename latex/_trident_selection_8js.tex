\hypertarget{_trident_selection_8js}{\section{src/\+Acme\+Group/\+Labo\+Bundle/\+Resources/public/js/tinymce/classes/dom/\+Trident\+Selection.js File Reference}
\label{_trident_selection_8js}\index{src/\+Acme\+Group/\+Labo\+Bundle/\+Resources/public/js/tinymce/classes/dom/\+Trident\+Selection.\+js@{src/\+Acme\+Group/\+Labo\+Bundle/\+Resources/public/js/tinymce/classes/dom/\+Trident\+Selection.\+js}}
}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{_trident_selection_8js_a1359649c9966499a55829678465fdfc1}{define} (\char`\"{}tinymce/dom/Trident\+Selection\char`\"{}, \mbox{[}$\,$\mbox{]}, function()\{function Selection(selection)\{var self=\hyperlink{tinymce_8jquery_8dev_8js_a05c09a5e9d53fa7adf0a7936038c2fa3}{this}, dom=selection.\+dom, F\+A\+L\+S\+E=\hyperlink{validate_8js_a5df37b7f02e5cdc7d9412b7f872b8e01}{false};function get\+Position(rng, \hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start})\{var check\+Rng, start\+Index=0, end\+Index, inside, children, child, \hyperlink{jquery-1_89_81_8js_a4a9f594d20d927164551fc7fa4751a2f}{offset}, index, \hyperlink{jquery-ui_8js_a5cd004409a854f3c106e2c3424b89292}{position}=-\/1, parent;check\+Rng=rng.\+duplicate();check\+Rng.\+collapse(\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start});parent=check\+Rng.\+parent\+Element();\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(parent.\+owner\+Document!==\hyperlink{outside_events_8js_a6966a4bf23931ad4f323b1b8c1e1801f}{selection.\+dom.\+doc})\{return;\}\hyperlink{extras_2_scroller_2media_2data_2server__processing_8php_a83084cf6f83823d8593882985353708d}{while}(parent.\+content\+Editable===\char`\"{}false\char`\"{})\{parent=parent.\+parent\+Node;\}\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(!parent.\+has\+Child\+Nodes())\{return\{node\+:parent, inside\+:1\};\}children=parent.\+children;end\+Index=children.\+length-\/1;\hyperlink{extras_2_scroller_2media_2data_2server__processing_8php_a83084cf6f83823d8593882985353708d}{while}(start\+Index$<$=end\+Index)\{index=Math.\+floor((start\+Index+end\+Index)/2);child=children\mbox{[}index\mbox{]};check\+Rng.\+move\+To\+Element\+Text(child);\hyperlink{jquery-ui_8js_a5cd004409a854f3c106e2c3424b89292}{position}=check\+Rng.\+compare\+End\+Points(\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start}? 'Start\+To\+Start'\+: 'End\+To\+End', rng);\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(\hyperlink{jquery-ui_8js_a5cd004409a854f3c106e2c3424b89292}{position} $>$ 0)\{end\+Index=index-\/1;\}\hyperlink{jquery_8iframe-transport_8js_a0544c3fe466e421738dae463968b70ba}{else} \hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(\hyperlink{jquery-ui_8js_a5cd004409a854f3c106e2c3424b89292}{position}$<$ 0)\{start\+Index=index+1;\}\hyperlink{jquery_8iframe-transport_8js_a0544c3fe466e421738dae463968b70ba}{else}\{return\{node\+:child\};\}\}\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(\hyperlink{jquery-ui_8js_a5cd004409a854f3c106e2c3424b89292}{position}$<$ 0)\{\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(!child)\{check\+Rng.\+move\+To\+Element\+Text(parent);check\+Rng.\+collapse(true);child=parent;inside=true;\}\hyperlink{jquery_8iframe-transport_8js_a0544c3fe466e421738dae463968b70ba}{else}\{check\+Rng.\+collapse(\hyperlink{validate_8js_a5df37b7f02e5cdc7d9412b7f872b8e01}{false});\}\hyperlink{jquery-1_89_81_8js_a4a9f594d20d927164551fc7fa4751a2f}{offset}=0;\hyperlink{extras_2_scroller_2media_2data_2server__processing_8php_a83084cf6f83823d8593882985353708d}{while}(check\+Rng.\+compare\+End\+Points(\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start}? 'Start\+To\+Start'\+: 'Start\+To\+End', rng)!==0)\{\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(check\+Rng.\+move('character', 1)===0$\vert$$\vert$parent!=check\+Rng.\+parent\+Element())\{break;\}\hyperlink{jquery-1_89_81_8js_a4a9f594d20d927164551fc7fa4751a2f}{offset}++;\}\}\hyperlink{jquery_8iframe-transport_8js_a0544c3fe466e421738dae463968b70ba}{else}\{check\+Rng.\+collapse(true);\hyperlink{jquery-1_89_81_8js_a4a9f594d20d927164551fc7fa4751a2f}{offset}=0;\hyperlink{extras_2_scroller_2media_2data_2server__processing_8php_a83084cf6f83823d8593882985353708d}{while}(check\+Rng.\+compare\+End\+Points(\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start}? 'Start\+To\+Start'\+: 'Start\+To\+End', rng)!==0)\{\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(check\+Rng.\+move('character',-\/1)===0$\vert$$\vert$parent!=check\+Rng.\+parent\+Element())\{break;\}\hyperlink{jquery-1_89_81_8js_a4a9f594d20d927164551fc7fa4751a2f}{offset}++;\}\}return\{node\+:child, position\+:position, offset\+:offset, inside\+:inside\};\}function get\+Range()\{var ie\+Range=selection.\+get\+Rng(), dom\+Range=dom.\+create\+Rng(), element, collapsed, tmp\+Range, element2, bookmark;element=ie\+Range.\+item?ie\+Range.\+item(0)\+:ie\+Range.\+parent\+Element();\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(element.\+owner\+Document!=\hyperlink{outside_events_8js_a6966a4bf23931ad4f323b1b8c1e1801f}{dom.\+doc})\{return dom\+Range;\}collapsed=selection.\+is\+Collapsed();\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(ie\+Range.\+item)\{dom\+Range.\+set\+Start(element.\+parent\+Node, dom.\+node\+Index(element));dom\+Range.\+set\+End(dom\+Range.\+start\+Container, dom\+Range.\+start\+Offset+1);return dom\+Range;\}function find\+End\+Point(\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start})\{var end\+Point=get\+Position(ie\+Range, \hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start}), container, \hyperlink{jquery-1_89_81_8js_a4a9f594d20d927164551fc7fa4751a2f}{offset}, text\+Node\+Offset=0, sibling, undef, node\+Value;container=end\+Point.\+node;\hyperlink{jquery-1_89_81_8js_a4a9f594d20d927164551fc7fa4751a2f}{offset}=\hyperlink{jquery-1_89_81_8js_a4a9f594d20d927164551fc7fa4751a2f}{end\+Point.\+offset};\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(end\+Point.\+inside \&\&!container.\+has\+Child\+Nodes())\{dom\+Range\mbox{[}\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start}? 'set\+Start'\+: 'set\+End'\mbox{]}(container, 0);return;\}\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(\hyperlink{jquery-1_89_81_8js_a4a9f594d20d927164551fc7fa4751a2f}{offset}===undef)\{dom\+Range\mbox{[}\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start}? 'set\+Start\+Before'\+: 'set\+End\+After'\mbox{]}(container);return;\}\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(\hyperlink{jquery-ui_8js_a5cd004409a854f3c106e2c3424b89292}{end\+Point.\+position}$<$ 0)\{sibling=end\+Point.\+inside?container.\+first\+Child\+:container.\+next\+Sibling;\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(!sibling)\{dom\+Range\mbox{[}\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start}? 'set\+Start\+After'\+: 'set\+End\+After'\mbox{]}(container);return;\}\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(!\hyperlink{jquery-1_89_81_8js_a4a9f594d20d927164551fc7fa4751a2f}{offset})\{\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(sibling.\+node\+Type==3)\{dom\+Range\mbox{[}\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start}? 'set\+Start'\+: 'set\+End'\mbox{]}(sibling, 0);\}\hyperlink{jquery_8iframe-transport_8js_a0544c3fe466e421738dae463968b70ba}{else}\{dom\+Range\mbox{[}\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start}? 'set\+Start\+Before'\+: 'set\+End\+Before'\mbox{]}(sibling);\}return;\}\hyperlink{extras_2_scroller_2media_2data_2server__processing_8php_a83084cf6f83823d8593882985353708d}{while}(sibling)\{node\+Value=sibling.\+node\+Value;text\+Node\+Offset+=node\+Value.\+length;\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(text\+Node\+Offset $>$=\hyperlink{jquery-1_89_81_8js_a4a9f594d20d927164551fc7fa4751a2f}{offset})\{container=sibling;text\+Node\+Offset-\/=\hyperlink{jquery-1_89_81_8js_a4a9f594d20d927164551fc7fa4751a2f}{offset};text\+Node\+Offset=node\+Value.\+length-\/text\+Node\+Offset;break;\}sibling=sibling.\+next\+Sibling;\}\}\hyperlink{jquery_8iframe-transport_8js_a0544c3fe466e421738dae463968b70ba}{else}\{sibling=container.\+previous\+Sibling;\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(!sibling)\{return dom\+Range\mbox{[}\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start}? 'set\+Start\+Before'\+: 'set\+End\+Before'\mbox{]}(container);\}\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(!\hyperlink{jquery-1_89_81_8js_a4a9f594d20d927164551fc7fa4751a2f}{offset})\{\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(container.\+node\+Type==3)\{dom\+Range\mbox{[}\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start}? 'set\+Start'\+: 'set\+End'\mbox{]}(sibling, container.\+node\+Value.\+length);\}\hyperlink{jquery_8iframe-transport_8js_a0544c3fe466e421738dae463968b70ba}{else}\{dom\+Range\mbox{[}\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start}? 'set\+Start\+After'\+: 'set\+End\+After'\mbox{]}(sibling);\}return;\}\hyperlink{extras_2_scroller_2media_2data_2server__processing_8php_a83084cf6f83823d8593882985353708d}{while}(sibling)\{text\+Node\+Offset+=sibling.\+node\+Value.\+length;\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(text\+Node\+Offset $>$=\hyperlink{jquery-1_89_81_8js_a4a9f594d20d927164551fc7fa4751a2f}{offset})\{container=sibling;text\+Node\+Offset-\/=\hyperlink{jquery-1_89_81_8js_a4a9f594d20d927164551fc7fa4751a2f}{offset};break;\}sibling=sibling.\+previous\+Sibling;\}\}dom\+Range\mbox{[}\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start}? 'set\+Start'\+: 'set\+End'\mbox{]}(container, text\+Node\+Offset);\}\hyperlink{jquery-1_89_81_8js_abe4cc9788f52e49485473dc699537388}{try}\{find\+End\+Point(true);\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(!collapsed)\{find\+End\+Point();\}\}\hyperlink{jquery-1_89_81_8js_a5bf45fc51bc0426586792b5f9cb95431}{catch}(ex)\{\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(ex.\+number==-\/2147024809)\{bookmark=self.\+get\+Bookmark(2);tmp\+Range=ie\+Range.\+duplicate();tmp\+Range.\+collapse(true);element=tmp\+Range.\+parent\+Element();\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(!collapsed)\{tmp\+Range=ie\+Range.\+duplicate();tmp\+Range.\+collapse(\hyperlink{validate_8js_a5df37b7f02e5cdc7d9412b7f872b8e01}{false});element2=tmp\+Range.\+parent\+Element();\hyperlink{jquery-ui_8js_a87f73c4f0391c1cf9fe60374a76d9a7b}{element2.\+inner\+H\+T\+M\+L}=\hyperlink{jquery-ui_8js_a87f73c4f0391c1cf9fe60374a76d9a7b}{element2.\+inner\+H\+T\+M\+L};\}\hyperlink{jquery-ui_8js_a87f73c4f0391c1cf9fe60374a76d9a7b}{element.\+inner\+H\+T\+M\+L}=\hyperlink{jquery-ui_8js_a87f73c4f0391c1cf9fe60374a76d9a7b}{element.\+inner\+H\+T\+M\+L};self.\+move\+To\+Bookmark(bookmark);ie\+Range=selection.\+get\+Rng();find\+End\+Point(true);\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(!collapsed)\{find\+End\+Point();\}\}\hyperlink{jquery_8iframe-transport_8js_a0544c3fe466e421738dae463968b70ba}{else}\{throw ex;\}\}return dom\+Range;\}this.\+get\+Bookmark=function(type)\{var rng=selection.\+get\+Rng(), bookmark=\{\};function get\+Indexes(node)\{var parent, \hyperlink{jquery_8mobile-1_83_81_8js_a11a10a6834f3c54a5380f4ff04d002a9}{root}, children, \hyperlink{validate_8js_a5e25b1d1bed9ab5f3174b76d6a722180}{i}, indexes=\mbox{[}$\,$\mbox{]};parent=node.\+parent\+Node;\hyperlink{jquery_8mobile-1_83_81_8js_a11a10a6834f3c54a5380f4ff04d002a9}{root}=dom.\+get\+Root().parent\+Node;\hyperlink{extras_2_scroller_2media_2data_2server__processing_8php_a83084cf6f83823d8593882985353708d}{while}(parent!=\hyperlink{jquery_8mobile-1_83_81_8js_a11a10a6834f3c54a5380f4ff04d002a9}{root} \&\&parent.\+node\+Type!==9)\{children=parent.\+children;\hyperlink{validate_8js_a5e25b1d1bed9ab5f3174b76d6a722180}{i}=children.\+length;\hyperlink{extras_2_scroller_2media_2data_2server__processing_8php_a83084cf6f83823d8593882985353708d}{while}(\hyperlink{validate_8js_a5e25b1d1bed9ab5f3174b76d6a722180}{i}-\/-\/)\{\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(node===children\mbox{[}\hyperlink{validate_8js_a5e25b1d1bed9ab5f3174b76d6a722180}{i}\mbox{]})\{\hyperlink{core_8constructor_8js_afa3ccdb0f651abf66d93864fc8419c98}{indexes.\+push}(\hyperlink{validate_8js_a5e25b1d1bed9ab5f3174b76d6a722180}{i});break;\}\}node=parent;parent=parent.\+parent\+Node;\}return indexes;\}function get\+Bookmark\+End\+Point(\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start})\{var \hyperlink{jquery-ui_8js_a5cd004409a854f3c106e2c3424b89292}{position};\hyperlink{jquery-ui_8js_a5cd004409a854f3c106e2c3424b89292}{position}=get\+Position(rng, \hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start});\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(\hyperlink{jquery-ui_8js_a5cd004409a854f3c106e2c3424b89292}{position})\{return\{\hyperlink{jquery-ui_8js_a5cd004409a854f3c106e2c3424b89292}{position\+:position.\+position}, \hyperlink{jquery-1_89_81_8js_a4a9f594d20d927164551fc7fa4751a2f}{offset\+:position.\+offset}, indexes\+:get\+Indexes(position.\+node), inside\+:position.\+inside\};\}\}\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(type===2)\{\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(!rng.\+item)\{\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{bookmark.\+start}=get\+Bookmark\+End\+Point(true);\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(!selection.\+is\+Collapsed())\{bookmark.\+end=get\+Bookmark\+End\+Point();\}\}\hyperlink{jquery_8iframe-transport_8js_a0544c3fe466e421738dae463968b70ba}{else}\{\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{bookmark.\+start}=\{ctrl\+:true, indexes\+:get\+Indexes(rng.\+item(0))\};\}\}return bookmark;\};this.\+move\+To\+Bookmark=function(bookmark)\{var rng, body=dom.\+doc.\+body;function resolve\+Indexes(indexes)\{var node, \hyperlink{validate_8js_a5e25b1d1bed9ab5f3174b76d6a722180}{i}, idx, children;node=dom.\+get\+Root();\hyperlink{tinymce_8jquery_8dev_8js_a4675a875b20881bc5f7011f49fbd4da7}{for}(\hyperlink{validate_8js_a5e25b1d1bed9ab5f3174b76d6a722180}{i}=indexes.\+length-\/1;\hyperlink{validate_8js_a5e25b1d1bed9ab5f3174b76d6a722180}{i} $>$=0;\hyperlink{validate_8js_a5e25b1d1bed9ab5f3174b76d6a722180}{i}-\/-\/)\{children=node.\+children;idx=indexes\mbox{[}\hyperlink{validate_8js_a5e25b1d1bed9ab5f3174b76d6a722180}{i}\mbox{]};\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(idx$<$=children.\+length-\/1)\{node=children\mbox{[}idx\mbox{]};\}\}return node;\}function set\+Bookmark\+End\+Point(\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start})\{var end\+Point=bookmark\mbox{[}\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start}? '\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start}'\+: 'end'\mbox{]}, move\+Left, move\+Rng, undef, \hyperlink{jquery-1_89_81_8js_a4a9f594d20d927164551fc7fa4751a2f}{offset};\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(end\+Point)\{move\+Left=\hyperlink{jquery-ui_8js_a5cd004409a854f3c106e2c3424b89292}{end\+Point.\+position} $>$ 0;move\+Rng=body.\+create\+Text\+Range();move\+Rng.\+move\+To\+Element\+Text(resolve\+Indexes(end\+Point.\+indexes));\hyperlink{jquery-1_89_81_8js_a4a9f594d20d927164551fc7fa4751a2f}{offset}=\hyperlink{jquery-1_89_81_8js_a4a9f594d20d927164551fc7fa4751a2f}{end\+Point.\+offset};\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(offset!==undef)\{move\+Rng.\+collapse(end\+Point.\+inside$\vert$$\vert$move\+Left);move\+Rng.\+move\+Start('character', move\+Left?-\/offset\+:offset);\}\hyperlink{jquery_8iframe-transport_8js_a0544c3fe466e421738dae463968b70ba}{else}\{move\+Rng.\+collapse(\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start});\}rng.\+set\+End\+Point(\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start}? 'Start\+To\+Start'\+: 'End\+To\+Start', move\+Rng);\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start})\{rng.\+collapse(true);\}\}\}\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{bookmark.\+start})\{\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(bookmark.\+start.\+ctrl)\{rng=body.\+create\+Control\+Range();rng.\+add\+Element(resolve\+Indexes(bookmark.\+start.\+indexes));\hyperlink{validate_8js_a107b4864f70df98ef4a521c0b2bc80c7}{rng.\+select}();\}\hyperlink{jquery_8iframe-transport_8js_a0544c3fe466e421738dae463968b70ba}{else}\{rng=body.\+create\+Text\+Range();set\+Bookmark\+End\+Point(true);set\+Bookmark\+End\+Point();\hyperlink{validate_8js_a107b4864f70df98ef4a521c0b2bc80c7}{rng.\+select}();\}\}\};this.\+add\+Range=function(rng)\{var ie\+Rng, ctrl\+Rng, start\+Container, start\+Offset, end\+Container, end\+Offset, sibling, \hyperlink{outside_events_8js_a6966a4bf23931ad4f323b1b8c1e1801f}{doc}=\hyperlink{outside_events_8js_a6966a4bf23931ad4f323b1b8c1e1801f}{selection.\+dom.\+doc}, body=doc.\+body, native\+Rng, ctrl\+Elm;function set\+End\+Point(\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start})\{var container, \hyperlink{jquery-1_89_81_8js_a4a9f594d20d927164551fc7fa4751a2f}{offset}, marker, tmp\+Rng, nodes;marker=dom.\+create('\hyperlink{media_2js_2jquery_8js_aa4d4888597588a84fd5b1184d00c91f3}{a}');container=\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start}?start\+Container\+:end\+Container;\hyperlink{jquery-1_89_81_8js_a4a9f594d20d927164551fc7fa4751a2f}{offset}=\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start}?start\+Offset\+:end\+Offset;tmp\+Rng=ie\+Rng.\+duplicate();\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(container==\hyperlink{outside_events_8js_a6966a4bf23931ad4f323b1b8c1e1801f}{doc}$\vert$$\vert$container==doc.\+document\+Element)\{container=body;\hyperlink{jquery-1_89_81_8js_a4a9f594d20d927164551fc7fa4751a2f}{offset}=0;\}\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(container.\+node\+Type==3)\{\hyperlink{jquery-ui_8js_a98ab1c3e007c3b40a9abc7f02b656401}{container.\+parent\+Node.\+insert\+Before}(marker, container);tmp\+Rng.\+move\+To\+Element\+Text(marker);tmp\+Rng.\+move\+Start('character', \hyperlink{jquery-1_89_81_8js_a4a9f594d20d927164551fc7fa4751a2f}{offset});\hyperlink{fullpage_2plugin_8min_8js_a3fe72a3812c61d06ea7c5cf2052f3dd2}{dom.\+remove}(marker);ie\+Rng.\+set\+End\+Point(\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start}? 'Start\+To\+Start'\+: 'End\+To\+End', tmp\+Rng);\}\hyperlink{jquery_8iframe-transport_8js_a0544c3fe466e421738dae463968b70ba}{else}\{nodes=container.\+child\+Nodes;\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(nodes.\+length)\{\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(\hyperlink{jquery-1_89_81_8js_a4a9f594d20d927164551fc7fa4751a2f}{offset} $>$=nodes.\+length)\{dom.\+insert\+After(marker, nodes\mbox{[}nodes.\+length-\/1\mbox{]});\}\hyperlink{jquery_8iframe-transport_8js_a0544c3fe466e421738dae463968b70ba}{else}\{\hyperlink{jquery-ui_8js_a98ab1c3e007c3b40a9abc7f02b656401}{container.\+insert\+Before}(marker, nodes\mbox{[}\hyperlink{jquery-1_89_81_8js_a4a9f594d20d927164551fc7fa4751a2f}{offset}\mbox{]});\}tmp\+Rng.\+move\+To\+Element\+Text(marker);\}\hyperlink{jquery_8iframe-transport_8js_a0544c3fe466e421738dae463968b70ba}{else} \hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(container.\+can\+Have\+H\+T\+M\+L)\{\hyperlink{jquery-ui_8js_a87f73c4f0391c1cf9fe60374a76d9a7b}{container.\+inner\+H\+T\+M\+L}= '$<$ span $>$ \&\#x\+F\+E\+F\+F;$<$/span $>$';marker=container.\+first\+Child;tmp\+Rng.\+move\+To\+Element\+Text(marker);tmp\+Rng.\+collapse(F\+A\+L\+S\+E);\}ie\+Rng.\+set\+End\+Point(\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start}? 'Start\+To\+Start'\+: 'End\+To\+End', tmp\+Rng);\hyperlink{fullpage_2plugin_8min_8js_a3fe72a3812c61d06ea7c5cf2052f3dd2}{dom.\+remove}(marker);\}\}start\+Container=rng.\+start\+Container;start\+Offset=rng.\+start\+Offset;end\+Container=rng.\+end\+Container;end\+Offset=rng.\+end\+Offset;ie\+Rng=body.\+create\+Text\+Range();\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(start\+Container==end\+Container \&\&start\+Container.\+node\+Type==1)\{\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(start\+Offset==end\+Offset \&\&!start\+Container.\+has\+Child\+Nodes())\{\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(start\+Container.\+can\+Have\+H\+T\+M\+L)\{sibling=start\+Container.\+previous\+Sibling;\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(sibling \&\&!sibling.\+has\+Child\+Nodes()\&\&dom.\+is\+Block(sibling))\{\hyperlink{jquery-ui_8js_a87f73c4f0391c1cf9fe60374a76d9a7b}{sibling.\+inner\+H\+T\+M\+L}= '\&\#x\+F\+E\+F\+F;';\}\hyperlink{jquery_8iframe-transport_8js_a0544c3fe466e421738dae463968b70ba}{else}\{sibling=\hyperlink{validate_8js_afb8e110345c45e74478894341ab6b28e}{null};\}\hyperlink{jquery-ui_8js_a87f73c4f0391c1cf9fe60374a76d9a7b}{start\+Container.\+inner\+H\+T\+M\+L}= '$<$ span $>$ \&\#x\+F\+E\+F\+F;$<$/span $>$$<$ span $>$ \&\#x\+F\+E\+F\+F;$<$/span $>$';ie\+Rng.\+move\+To\+Element\+Text(start\+Container.\+last\+Child);\hyperlink{validate_8js_a107b4864f70df98ef4a521c0b2bc80c7}{ie\+Rng.\+select}();dom.\+doc.\+selection.\+clear();\hyperlink{jquery-ui_8js_a87f73c4f0391c1cf9fe60374a76d9a7b}{start\+Container.\+inner\+H\+T\+M\+L}= '';\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(sibling)\{\hyperlink{jquery-ui_8js_a87f73c4f0391c1cf9fe60374a76d9a7b}{sibling.\+inner\+H\+T\+M\+L}= '';\}return;\}\hyperlink{jquery_8iframe-transport_8js_a0544c3fe466e421738dae463968b70ba}{else}\{start\+Offset=dom.\+node\+Index(start\+Container);start\+Container=start\+Container.\+parent\+Node;\}\}\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(start\+Offset==end\+Offset-\/1)\{\hyperlink{jquery-1_89_81_8js_abe4cc9788f52e49485473dc699537388}{try}\{ctrl\+Elm=start\+Container.\+child\+Nodes\mbox{[}start\+Offset\mbox{]};ctrl\+Rng=body.\+create\+Control\+Range();ctrl\+Rng.\+add\+Element(ctrl\+Elm);\hyperlink{validate_8js_a107b4864f70df98ef4a521c0b2bc80c7}{ctrl\+Rng.\+select}();native\+Rng=selection.\+get\+Rng();\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(native\+Rng.\+item \&\&ctrl\+Elm===native\+Rng.\+item(0))\{return;\}\}\hyperlink{jquery-1_89_81_8js_a5bf45fc51bc0426586792b5f9cb95431}{catch}(ex)\{\}\}\}set\+End\+Point(true);set\+End\+Point();\hyperlink{validate_8js_a107b4864f70df98ef4a521c0b2bc80c7}{ie\+Rng.\+select}();\};this.\+get\+Range\+At=get\+Range;\}return Selection;\})
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{_trident_selection_8js_a1359649c9966499a55829678465fdfc1}{\index{Trident\+Selection.\+js@{Trident\+Selection.\+js}!define@{define}}
\index{define@{define}!Trident\+Selection.\+js@{Trident\+Selection.\+js}}
\subsubsection[{define}]{\setlength{\rightskip}{0pt plus 5cm}define (
\begin{DoxyParamCaption}
\item[{\char`\"{}tinymce/dom/Trident\+Selection\char`\"{}}]{, }
\item[{function()\{function Selection(selection)\{var self={\bf this}, dom=selection.\+dom, F\+A\+L\+S\+E={\bf false};function get\+Position(rng, {\bf start})\{var check\+Rng, start\+Index=0, end\+Index, inside, children, child, {\bf offset}, index, {\bf position}=-\/1, parent;check\+Rng=rng.\+duplicate();check\+Rng.\+collapse({\bf start});parent=check\+Rng.\+parent\+Element();{\bf if}(parent.\+owner\+Document!=={\bf selection.\+dom.\+doc})\{return;\}{\bf while}(parent.\+content\+Editable===\char`\"{}false\char`\"{})\{parent=parent.\+parent\+Node;\}{\bf if}(!parent.\+has\+Child\+Nodes())\{return\{node\+:parent, inside\+:1\};\}children=parent.\+children;end\+Index=children.\+length-\/1;{\bf while}(start\+Index$<$=end\+Index)\{index=Math.\+floor((start\+Index+end\+Index)/2);child=children\mbox{[}index\mbox{]};check\+Rng.\+move\+To\+Element\+Text(child);{\bf position}=check\+Rng.\+compare\+End\+Points({\bf start}? 'Start\+To\+Start'\+: 'End\+To\+End', rng);{\bf if}({\bf position} $>$ 0)\{end\+Index=index-\/1;\}{\bf else} {\bf if}({\bf position}$<$ 0)\{start\+Index=index+1;\}{\bf else}\{return\{node\+:child\};\}\}{\bf if}({\bf position}$<$ 0)\{{\bf if}(!child)\{check\+Rng.\+move\+To\+Element\+Text(parent);check\+Rng.\+collapse(true);child=parent;inside=true;\}{\bf else}\{check\+Rng.\+collapse({\bf false});\}{\bf offset}=0;{\bf while}(check\+Rng.\+compare\+End\+Points({\bf start}? 'Start\+To\+Start'\+: 'Start\+To\+End', rng)!==0)\{{\bf if}(check\+Rng.\+move('character', 1)===0$\vert$$\vert$parent!=check\+Rng.\+parent\+Element())\{break;\}{\bf offset}++;\}\}{\bf else}\{check\+Rng.\+collapse(true);{\bf offset}=0;{\bf while}(check\+Rng.\+compare\+End\+Points({\bf start}? 'Start\+To\+Start'\+: 'Start\+To\+End', rng)!==0)\{{\bf if}(check\+Rng.\+move('character',-\/1)===0$\vert$$\vert$parent!=check\+Rng.\+parent\+Element())\{break;\}{\bf offset}++;\}\}return\{node\+:child, position\+:position, offset\+:offset, inside\+:inside\};\}function get\+Range()\{var ie\+Range=selection.\+get\+Rng(), dom\+Range=dom.\+create\+Rng(), element, collapsed, tmp\+Range, element2, bookmark;element=ie\+Range.\+item?ie\+Range.\+item(0)\+:ie\+Range.\+parent\+Element();{\bf if}(element.\+owner\+Document!={\bf dom.\+doc})\{return dom\+Range;\}collapsed=selection.\+is\+Collapsed();{\bf if}(ie\+Range.\+item)\{dom\+Range.\+set\+Start(element.\+parent\+Node, dom.\+node\+Index(element));dom\+Range.\+set\+End(dom\+Range.\+start\+Container, dom\+Range.\+start\+Offset+1);return dom\+Range;\}function find\+End\+Point({\bf start})\{var end\+Point=get\+Position(ie\+Range, {\bf start}), container, {\bf offset}, text\+Node\+Offset=0, sibling, undef, node\+Value;container=end\+Point.\+node;{\bf offset}={\bf end\+Point.\+offset};{\bf if}(end\+Point.\+inside \&\&!container.\+has\+Child\+Nodes())\{dom\+Range\mbox{[}{\bf start}? 'set\+Start'\+: 'set\+End'\mbox{]}(container, 0);return;\}{\bf if}({\bf offset}===undef)\{dom\+Range\mbox{[}{\bf start}? 'set\+Start\+Before'\+: 'set\+End\+After'\mbox{]}(container);return;\}{\bf if}({\bf end\+Point.\+position}$<$ 0)\{sibling=end\+Point.\+inside?container.\+first\+Child\+:container.\+next\+Sibling;{\bf if}(!sibling)\{dom\+Range\mbox{[}{\bf start}? 'set\+Start\+After'\+: 'set\+End\+After'\mbox{]}(container);return;\}{\bf if}(!{\bf offset})\{{\bf if}(sibling.\+node\+Type==3)\{dom\+Range\mbox{[}{\bf start}? 'set\+Start'\+: 'set\+End'\mbox{]}(sibling, 0);\}{\bf else}\{dom\+Range\mbox{[}{\bf start}? 'set\+Start\+Before'\+: 'set\+End\+Before'\mbox{]}(sibling);\}return;\}{\bf while}(sibling)\{node\+Value=sibling.\+node\+Value;text\+Node\+Offset+=node\+Value.\+length;{\bf if}(text\+Node\+Offset $>$={\bf offset})\{container=sibling;text\+Node\+Offset-\/={\bf offset};text\+Node\+Offset=node\+Value.\+length-\/text\+Node\+Offset;break;\}sibling=sibling.\+next\+Sibling;\}\}{\bf else}\{sibling=container.\+previous\+Sibling;{\bf if}(!sibling)\{return dom\+Range\mbox{[}{\bf start}? 'set\+Start\+Before'\+: 'set\+End\+Before'\mbox{]}(container);\}{\bf if}(!{\bf offset})\{{\bf if}(container.\+node\+Type==3)\{dom\+Range\mbox{[}{\bf start}? 'set\+Start'\+: 'set\+End'\mbox{]}(sibling, container.\+node\+Value.\+length);\}{\bf else}\{dom\+Range\mbox{[}{\bf start}? 'set\+Start\+After'\+: 'set\+End\+After'\mbox{]}(sibling);\}return;\}{\bf while}(sibling)\{text\+Node\+Offset+=sibling.\+node\+Value.\+length;{\bf if}(text\+Node\+Offset $>$={\bf offset})\{container=sibling;text\+Node\+Offset-\/={\bf offset};break;\}sibling=sibling.\+previous\+Sibling;\}\}dom\+Range\mbox{[}{\bf start}? 'set\+Start'\+: 'set\+End'\mbox{]}(container, text\+Node\+Offset);\}{\bf try}\{find\+End\+Point(true);{\bf if}(!collapsed)\{find\+End\+Point();\}\}{\bf catch}(ex)\{{\bf if}(ex.\+number==-\/2147024809)\{bookmark=self.\+get\+Bookmark(2);tmp\+Range=ie\+Range.\+duplicate();tmp\+Range.\+collapse(true);element=tmp\+Range.\+parent\+Element();{\bf if}(!collapsed)\{tmp\+Range=ie\+Range.\+duplicate();tmp\+Range.\+collapse({\bf false});element2=tmp\+Range.\+parent\+Element();{\bf element2.\+inner\+H\+T\+M\+L}={\bf element2.\+inner\+H\+T\+M\+L};\}{\bf element.\+inner\+H\+T\+M\+L}={\bf element.\+inner\+H\+T\+M\+L};self.\+move\+To\+Bookmark(bookmark);ie\+Range=selection.\+get\+Rng();find\+End\+Point(true);{\bf if}(!collapsed)\{find\+End\+Point();\}\}{\bf else}\{throw ex;\}\}return dom\+Range;\}this.\+get\+Bookmark=function(type)\{var rng=selection.\+get\+Rng(), bookmark=\{\};function get\+Indexes(node)\{var parent, {\bf root}, children, {\bf i}, indexes=\mbox{[}$\,$\mbox{]};parent=node.\+parent\+Node;{\bf root}=dom.\+get\+Root().parent\+Node;{\bf while}(parent!={\bf root} \&\&parent.\+node\+Type!==9)\{children=parent.\+children;{\bf i}=children.\+length;{\bf while}({\bf i}-\/-\/)\{{\bf if}(node===children\mbox{[}{\bf i}\mbox{]})\{{\bf indexes.\+push}({\bf i});break;\}\}node=parent;parent=parent.\+parent\+Node;\}return indexes;\}function get\+Bookmark\+End\+Point({\bf start})\{var {\bf position};{\bf position}=get\+Position(rng, {\bf start});{\bf if}({\bf position})\{return\{{\bf position\+:position.\+position}, {\bf offset\+:position.\+offset}, indexes\+:get\+Indexes(position.\+node), inside\+:position.\+inside\};\}\}{\bf if}(type===2)\{{\bf if}(!rng.\+item)\{{\bf bookmark.\+start}=get\+Bookmark\+End\+Point(true);{\bf if}(!selection.\+is\+Collapsed())\{bookmark.\+end=get\+Bookmark\+End\+Point();\}\}{\bf else}\{{\bf bookmark.\+start}=\{ctrl\+:true, indexes\+:get\+Indexes(rng.\+item(0))\};\}\}return bookmark;\};this.\+move\+To\+Bookmark=function(bookmark)\{var rng, body=dom.\+doc.\+body;function resolve\+Indexes(indexes)\{var node, {\bf i}, idx, children;node=dom.\+get\+Root();{\bf for}({\bf i}=indexes.\+length-\/1;{\bf i} $>$=0;{\bf i}-\/-\/)\{children=node.\+children;idx=indexes\mbox{[}{\bf i}\mbox{]};{\bf if}(idx$<$=children.\+length-\/1)\{node=children\mbox{[}idx\mbox{]};\}\}return node;\}function set\+Bookmark\+End\+Point({\bf start})\{var end\+Point=bookmark\mbox{[}{\bf start}? '{\bf start}'\+: 'end'\mbox{]}, move\+Left, move\+Rng, undef, {\bf offset};{\bf if}(end\+Point)\{move\+Left={\bf end\+Point.\+position} $>$ 0;move\+Rng=body.\+create\+Text\+Range();move\+Rng.\+move\+To\+Element\+Text(resolve\+Indexes(end\+Point.\+indexes));{\bf offset}={\bf end\+Point.\+offset};{\bf if}(offset!==undef)\{move\+Rng.\+collapse(end\+Point.\+inside$\vert$$\vert$move\+Left);move\+Rng.\+move\+Start('character', move\+Left?-\/offset\+:offset);\}{\bf else}\{move\+Rng.\+collapse({\bf start});\}rng.\+set\+End\+Point({\bf start}? 'Start\+To\+Start'\+: 'End\+To\+Start', move\+Rng);{\bf if}({\bf start})\{rng.\+collapse(true);\}\}\}{\bf if}({\bf bookmark.\+start})\{{\bf if}(bookmark.\+start.\+ctrl)\{rng=body.\+create\+Control\+Range();rng.\+add\+Element(resolve\+Indexes(bookmark.\+start.\+indexes));{\bf rng.\+select}();\}{\bf else}\{rng=body.\+create\+Text\+Range();set\+Bookmark\+End\+Point(true);set\+Bookmark\+End\+Point();{\bf rng.\+select}();\}\}\};this.\+add\+Range=function(rng)\{var ie\+Rng, ctrl\+Rng, start\+Container, start\+Offset, end\+Container, end\+Offset, sibling, {\bf doc}={\bf selection.\+dom.\+doc}, body=doc.\+body, native\+Rng, ctrl\+Elm;function set\+End\+Point({\bf start})\{var container, {\bf offset}, marker, tmp\+Rng, nodes;marker=dom.\+create('{\bf a}');container={\bf start}?start\+Container\+:end\+Container;{\bf offset}={\bf start}?start\+Offset\+:end\+Offset;tmp\+Rng=ie\+Rng.\+duplicate();{\bf if}(container=={\bf doc}$\vert$$\vert$container==doc.\+document\+Element)\{container=body;{\bf offset}=0;\}{\bf if}(container.\+node\+Type==3)\{{\bf container.\+parent\+Node.\+insert\+Before}(marker, container);tmp\+Rng.\+move\+To\+Element\+Text(marker);tmp\+Rng.\+move\+Start('character', {\bf offset});{\bf dom.\+remove}(marker);ie\+Rng.\+set\+End\+Point({\bf start}? 'Start\+To\+Start'\+: 'End\+To\+End', tmp\+Rng);\}{\bf else}\{nodes=container.\+child\+Nodes;{\bf if}(nodes.\+length)\{{\bf if}({\bf offset} $>$=nodes.\+length)\{dom.\+insert\+After(marker, nodes\mbox{[}nodes.\+length-\/1\mbox{]});\}{\bf else}\{{\bf container.\+insert\+Before}(marker, nodes\mbox{[}{\bf offset}\mbox{]});\}tmp\+Rng.\+move\+To\+Element\+Text(marker);\}{\bf else} {\bf if}(container.\+can\+Have\+H\+T\+M\+L)\{{\bf container.\+inner\+H\+T\+M\+L}= '$<$ span $>$ \&\#x\+F\+E\+F\+F;$<$/span $>$';marker=container.\+first\+Child;tmp\+Rng.\+move\+To\+Element\+Text(marker);tmp\+Rng.\+collapse(F\+A\+L\+S\+E);\}ie\+Rng.\+set\+End\+Point({\bf start}? 'Start\+To\+Start'\+: 'End\+To\+End', tmp\+Rng);{\bf dom.\+remove}(marker);\}\}start\+Container=rng.\+start\+Container;start\+Offset=rng.\+start\+Offset;end\+Container=rng.\+end\+Container;end\+Offset=rng.\+end\+Offset;ie\+Rng=body.\+create\+Text\+Range();{\bf if}(start\+Container==end\+Container \&\&start\+Container.\+node\+Type==1)\{{\bf if}(start\+Offset==end\+Offset \&\&!start\+Container.\+has\+Child\+Nodes())\{{\bf if}(start\+Container.\+can\+Have\+H\+T\+M\+L)\{sibling=start\+Container.\+previous\+Sibling;{\bf if}(sibling \&\&!sibling.\+has\+Child\+Nodes()\&\&dom.\+is\+Block(sibling))\{{\bf sibling.\+inner\+H\+T\+M\+L}= '\&\#x\+F\+E\+F\+F;';\}{\bf else}\{sibling={\bf null};\}{\bf start\+Container.\+inner\+H\+T\+M\+L}= '$<$ span $>$ \&\#x\+F\+E\+F\+F;$<$/span $>$$<$ span $>$ \&\#x\+F\+E\+F\+F;$<$/span $>$';ie\+Rng.\+move\+To\+Element\+Text(start\+Container.\+last\+Child);{\bf ie\+Rng.\+select}();dom.\+doc.\+selection.\+clear();{\bf start\+Container.\+inner\+H\+T\+M\+L}= '';{\bf if}(sibling)\{{\bf sibling.\+inner\+H\+T\+M\+L}= '';\}return;\}{\bf else}\{start\+Offset=dom.\+node\+Index(start\+Container);start\+Container=start\+Container.\+parent\+Node;\}\}{\bf if}(start\+Offset==end\+Offset-\/1)\{{\bf try}\{ctrl\+Elm=start\+Container.\+child\+Nodes\mbox{[}start\+Offset\mbox{]};ctrl\+Rng=body.\+create\+Control\+Range();ctrl\+Rng.\+add\+Element(ctrl\+Elm);{\bf ctrl\+Rng.\+select}();native\+Rng=selection.\+get\+Rng();{\bf if}(native\+Rng.\+item \&\&ctrl\+Elm===native\+Rng.\+item(0))\{return;\}\}{\bf catch}(ex)\{\}\}\}set\+End\+Point(true);set\+End\+Point();{\bf ie\+Rng.\+select}();\};this.\+get\+Range\+At=get\+Range;\}return Selection;\}}]{}
\end{DoxyParamCaption}
)}}\label{_trident_selection_8js_a1359649c9966499a55829678465fdfc1}
