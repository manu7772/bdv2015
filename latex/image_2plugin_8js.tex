\hypertarget{image_2plugin_8js}{\section{src/\+Acme\+Group/\+Labo\+Bundle/\+Resources/public/js/tinymce/plugins/image/plugin.js File Reference}
\label{image_2plugin_8js}\index{src/\+Acme\+Group/\+Labo\+Bundle/\+Resources/public/js/tinymce/plugins/image/plugin.\+js@{src/\+Acme\+Group/\+Labo\+Bundle/\+Resources/public/js/tinymce/plugins/image/plugin.\+js}}
}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{legacyoutput_2plugin_8min_8js_a9e0c63e13122add16db57b355b91bbc8}{tinymce} Plugin\+Manager \hyperlink{image_2plugin_8js_ab6d48e73e4597401d510253ac0b2c8ca}{add} ('image', function(editor)\{function get\+Image\+Size(url, callback)\{var img=document.\+create\+Element('img');function done(width, \hyperlink{jquery-ui_8js_a53b668b89fc43ad1964bca7d45307d62}{height})\{\hyperlink{jquery-ui_8js_ab13208bd0b29533656fdd9fdfc2de509}{img.\+parent\+Node.\+remove\+Child}(img);callback(\{width\+:width, height\+:height\});\}img.\+onload=function()\{done(img.\+client\+Width, img.\+client\+Height);\};img.\+onerror=function()\{done();\};img.\+src=url;var style=img.\+style;style.\+visibility= '\hyperlink{media_2js_2jquery_8js_a6d83a3278d86577a50e8a86937570a90}{hidden}';\hyperlink{jquery-ui_8js_a5cd004409a854f3c106e2c3424b89292}{style.\+position}= 'fixed';style.\+bottom=style.\+left=0;style.\+width=\hyperlink{jquery-ui_8js_a53b668b89fc43ad1964bca7d45307d62}{style.\+height}= 'auto';\hyperlink{jquery-ui_8js_a282eb35406abfe6001815a393642b8cb}{document.\+body.\+append\+Child}(img);\}function create\+Image\+List(callback)\{return function()\{var image\+List=editor.\+settings.\+image\+\_\+list;\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(\hyperlink{extras_2_scroller_2media_2docs_2media_2js_2sh_brush_j_script_8js_a93a9266f92d6d68644e7aa63da3caa11}{typeof}(image\+List)==\char`\"{}string\char`\"{})\{tinymce.\+util.\+X\+H\+R.\+send(\{url\+:image\+List, success\+:function(text)\{callback(tinymce.\+util.\+J\+S\+O\+N.\+parse(text));\}\});\}\hyperlink{jquery_8iframe-transport_8js_a0544c3fe466e421738dae463968b70ba}{else}\{callback(image\+List);\}\};\}function show\+Dialog(image\+List)\{var win, \hyperlink{fullpage_2plugin_8js_a718c1bf5a3bf21ebb980203b142e5b75}{data}=\{\}, dom=editor.\+dom, img\+Elm=editor.\+selection.\+get\+Node();var width, \hyperlink{jquery-ui_8js_a53b668b89fc43ad1964bca7d45307d62}{height}, image\+List\+Ctrl;function build\+Image\+List()\{var image\+List\+Items=\mbox{[}\{text\+: 'None', value\+: ''\}\mbox{]};\hyperlink{fullpage_2plugin_8min_8js_a536422939f8cd6b5867a8fb424c3c02e}{tinymce.\+each}(image\+List, function(image)\{\hyperlink{core_8constructor_8js_afa3ccdb0f651abf66d93864fc8419c98}{image\+List\+Items.\+push}(\{text\+:image.\+text$\vert$$\vert$\hyperlink{jquery_8fancybox_8pack_8js_a293d418e53eecdc63689e8e677088684}{image.\+title}, value\+:editor.\+convert\+U\+R\+L(\hyperlink{fullpage_2plugin_8min_8js_ac56c57897e10f699d124e0103921aa20}{image.\+value}$\vert$$\vert$image.\+url, 'src'), menu\+:image.\+menu\});\});return image\+List\+Items;\}function recalc\+Size(\hyperlink{validate_8js_acafd152b1d81d2bd0f5775007db75586}{e})\{var width\+Ctrl, height\+Ctrl, new\+Width, new\+Height;width\+Ctrl=win.\+find('\#width')\mbox{[}0\mbox{]};height\+Ctrl=win.\+find('\#\hyperlink{jquery-ui_8js_a53b668b89fc43ad1964bca7d45307d62}{height}')\mbox{[}0\mbox{]};new\+Width=\hyperlink{fullpage_2plugin_8min_8js_ac56c57897e10f699d124e0103921aa20}{width\+Ctrl.\+value}();new\+Height=\hyperlink{fullpage_2plugin_8min_8js_ac56c57897e10f699d124e0103921aa20}{height\+Ctrl.\+value}();\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(win.\+find('\#constrain')\mbox{[}0\mbox{]}.checked()\&\&width \&\&\hyperlink{jquery-ui_8js_a53b668b89fc43ad1964bca7d45307d62}{height} \&\&new\+Width \&\&new\+Height)\{\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(e.\+control==width\+Ctrl)\{new\+Height=\hyperlink{jquery-ui_8js_abcf15bd0ceed587926978d51b71f3c85}{Math.\+round}((new\+Width/width)$\ast$new\+Height);\hyperlink{fullpage_2plugin_8min_8js_ac56c57897e10f699d124e0103921aa20}{height\+Ctrl.\+value}(new\+Height);\}\hyperlink{jquery_8iframe-transport_8js_a0544c3fe466e421738dae463968b70ba}{else}\{new\+Width=\hyperlink{jquery-ui_8js_abcf15bd0ceed587926978d51b71f3c85}{Math.\+round}((new\+Height/\hyperlink{jquery-ui_8js_a53b668b89fc43ad1964bca7d45307d62}{height})$\ast$new\+Width);\hyperlink{fullpage_2plugin_8min_8js_ac56c57897e10f699d124e0103921aa20}{width\+Ctrl.\+value}(new\+Width);\}\}width=new\+Width;\hyperlink{jquery-ui_8js_a53b668b89fc43ad1964bca7d45307d62}{height}=new\+Height;\}function on\+Submit\+Form()\{function wait\+Load(img\+Elm)\{function select\+Image()\{img\+Elm.\+onload=img\+Elm.\+onerror=\hyperlink{validate_8js_afb8e110345c45e74478894341ab6b28e}{null};\hyperlink{validate_8js_a107b4864f70df98ef4a521c0b2bc80c7}{editor.\+selection.\+select}(img\+Elm);editor.\+node\+Changed();\}img\+Elm.\+onload=function()\{\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(!data.\+width \&\&!\hyperlink{jquery-ui_8js_a53b668b89fc43ad1964bca7d45307d62}{data.\+height})\{\hyperlink{fullpage_2plugin_8min_8js_a7d161a9e201f33c20ddc045115f93fd4}{dom.\+set\+Attribs}(img\+Elm,\{width\+:img\+Elm.\+client\+Width, height\+:img\+Elm.\+client\+Height\});\}select\+Image();\};img\+Elm.\+onerror=select\+Image;\}var \hyperlink{fullpage_2plugin_8js_a718c1bf5a3bf21ebb980203b142e5b75}{data}=win.\+to\+J\+S\+O\+N();\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(data.\+width=== '')\{data.\+width=\hyperlink{validate_8js_afb8e110345c45e74478894341ab6b28e}{null};\}\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(\hyperlink{jquery-ui_8js_a53b668b89fc43ad1964bca7d45307d62}{data.\+height}=== '')\{\hyperlink{jquery-ui_8js_a53b668b89fc43ad1964bca7d45307d62}{data.\+height}=\hyperlink{validate_8js_afb8e110345c45e74478894341ab6b28e}{null};\}\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(data.\+style=== '')\{data.\+style=\hyperlink{validate_8js_afb8e110345c45e74478894341ab6b28e}{null};\}\hyperlink{fullpage_2plugin_8js_a718c1bf5a3bf21ebb980203b142e5b75}{data}=\{src\+:data.\+src, alt\+:data.\+alt, width\+:data.\+width, \hyperlink{jquery-ui_8js_a53b668b89fc43ad1964bca7d45307d62}{height\+:data.\+height}, style\+:data.\+style\};editor.\+undo\+Manager.\+transact(function()\{\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(!data.\+src)\{\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(img\+Elm)\{\hyperlink{fullpage_2plugin_8min_8js_a3fe72a3812c61d06ea7c5cf2052f3dd2}{dom.\+remove}(img\+Elm);editor.\+node\+Changed();\}return;\}\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(!img\+Elm)\{data.\+id= '\+\_\+\+\_\+mcenew';\hyperlink{fullpage_2plugin_8js_a465938ea1cd397f0d555ca5c6a621f56}{editor.\+selection.\+set\+Content}(dom.\+create\+H\+T\+M\+L('img', \hyperlink{fullpage_2plugin_8js_a718c1bf5a3bf21ebb980203b142e5b75}{data}));img\+Elm=dom.\+get('\+\_\+\+\_\+mcenew');dom.\+set\+Attrib(img\+Elm, 'id', \hyperlink{validate_8js_afb8e110345c45e74478894341ab6b28e}{null});\}\hyperlink{jquery_8iframe-transport_8js_a0544c3fe466e421738dae463968b70ba}{else}\{\hyperlink{fullpage_2plugin_8min_8js_a7d161a9e201f33c20ddc045115f93fd4}{dom.\+set\+Attribs}(img\+Elm, \hyperlink{fullpage_2plugin_8js_a718c1bf5a3bf21ebb980203b142e5b75}{data});\}wait\+Load(img\+Elm);\});\}function remove\+Pixel\+Suffix(\hyperlink{fullpage_2plugin_8min_8js_ac56c57897e10f699d124e0103921aa20}{value})\{\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(\hyperlink{fullpage_2plugin_8min_8js_ac56c57897e10f699d124e0103921aa20}{value})\{\hyperlink{fullpage_2plugin_8min_8js_ac56c57897e10f699d124e0103921aa20}{value}=value.\+replace(/px \$/, '');\}return \hyperlink{fullpage_2plugin_8min_8js_ac56c57897e10f699d124e0103921aa20}{value};\}function src\+Change()\{\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(image\+List\+Ctrl)\{\hyperlink{fullpage_2plugin_8min_8js_ac56c57897e10f699d124e0103921aa20}{image\+List\+Ctrl.\+value}(editor.\+convert\+U\+R\+L(\hyperlink{fullpage_2plugin_8min_8js_ac56c57897e10f699d124e0103921aa20}{this.\+value}(), 'src'));\}get\+Image\+Size(\hyperlink{fullpage_2plugin_8min_8js_ac56c57897e10f699d124e0103921aa20}{this.\+value}(), function(\hyperlink{fullpage_2plugin_8js_a718c1bf5a3bf21ebb980203b142e5b75}{data})\{\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(data.\+width \&\&\hyperlink{jquery-ui_8js_a53b668b89fc43ad1964bca7d45307d62}{data.\+height})\{width=data.\+width;\hyperlink{jquery-ui_8js_a53b668b89fc43ad1964bca7d45307d62}{height}=\hyperlink{jquery-ui_8js_a53b668b89fc43ad1964bca7d45307d62}{data.\+height};win.\+find('\#width').\hyperlink{fullpage_2plugin_8min_8js_ac56c57897e10f699d124e0103921aa20}{value}(width);win.\+find('\#\hyperlink{jquery-ui_8js_a53b668b89fc43ad1964bca7d45307d62}{height}').\hyperlink{fullpage_2plugin_8min_8js_ac56c57897e10f699d124e0103921aa20}{value}(\hyperlink{jquery-ui_8js_a53b668b89fc43ad1964bca7d45307d62}{height});\}\});\}width=dom.\+get\+Attrib(img\+Elm, 'width');\hyperlink{jquery-ui_8js_a53b668b89fc43ad1964bca7d45307d62}{height}=dom.\+get\+Attrib(img\+Elm, '\hyperlink{jquery-ui_8js_a53b668b89fc43ad1964bca7d45307d62}{height}');\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(img\+Elm.\+node\+Name== 'I\+M\+G'\&\&!img\+Elm.\+get\+Attribute('\hyperlink{fullpage_2plugin_8js_a718c1bf5a3bf21ebb980203b142e5b75}{data}-\/mce-\/object'))\{\hyperlink{fullpage_2plugin_8js_a718c1bf5a3bf21ebb980203b142e5b75}{data}=\{src\+:dom.\+get\+Attrib(img\+Elm, 'src'), alt\+:dom.\+get\+Attrib(img\+Elm, 'alt'), width\+:width, height\+:height\};\}\hyperlink{jquery_8iframe-transport_8js_a0544c3fe466e421738dae463968b70ba}{else}\{img\+Elm=\hyperlink{validate_8js_afb8e110345c45e74478894341ab6b28e}{null};\}\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(image\+List)\{image\+List\+Ctrl=\{type\+: 'listbox', label\+: 'Image list', values\+:build\+Image\+List(), value\+:data.\+src \&\&editor.\+convert\+U\+R\+L(data.\+src, 'src'), onselect\+:function(\hyperlink{validate_8js_acafd152b1d81d2bd0f5775007db75586}{e})\{var alt\+Ctrl=win.\+find('\#alt');\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(!\hyperlink{fullpage_2plugin_8min_8js_ac56c57897e10f699d124e0103921aa20}{alt\+Ctrl.\+value}()$\vert$$\vert$(e.\+last\+Control \&\&\hyperlink{fullpage_2plugin_8min_8js_ac56c57897e10f699d124e0103921aa20}{alt\+Ctrl.\+value}()==e.\+last\+Control.\+text()))\{\hyperlink{fullpage_2plugin_8min_8js_ac56c57897e10f699d124e0103921aa20}{alt\+Ctrl.\+value}(e.\+control.\+text());\}win.\+find('\#src').\hyperlink{fullpage_2plugin_8min_8js_ac56c57897e10f699d124e0103921aa20}{value}(\hyperlink{fullpage_2plugin_8min_8js_ac56c57897e10f699d124e0103921aa20}{e.\+control.\+value}());\}, on\+Post\+Render\+:function()\{image\+List\+Ctrl=\hyperlink{tinymce_8jquery_8dev_8js_a05c09a5e9d53fa7adf0a7936038c2fa3}{this};\}\};\}var general\+Form\+Items=\mbox{[}\{name\+: 'src', type\+: 'filepicker', filetype\+: 'image', label\+: 'Source', autofocus\+:true, onchange\+:src\+Change\}, image\+List\+Ctrl,\{name\+: 'alt', type\+: 'textbox', label\+: 'Image description'\},\{type\+: 'container', label\+: 'Dimensions', layout\+: 'flex', direction\+: 'row', align\+: 'center', spacing\+:5, items\+:\mbox{[}\{name\+: 'width', type\+: 'textbox', max\+Length\+:3, size\+:3, onchange\+:recalc\+Size\},\{type\+: 'label', text\+: 'x'\},\{name\+: '\hyperlink{jquery-ui_8js_a53b668b89fc43ad1964bca7d45307d62}{height}', type\+: 'textbox', max\+Length\+:3, size\+:3, onchange\+:recalc\+Size\},\{name\+: 'constrain', type\+: 'checkbox', checked\+:true, text\+: 'Constrain proportions'\}\mbox{]}\}\mbox{]};function update\+Style()\{function add\+Pixel\+Suffix(\hyperlink{fullpage_2plugin_8min_8js_ac56c57897e10f699d124e0103921aa20}{value})\{\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(value.\+length $>$ 0 \&\&/$^\wedge$\mbox{[}0-\/9\mbox{]}+\$/.test(\hyperlink{fullpage_2plugin_8min_8js_ac56c57897e10f699d124e0103921aa20}{value}))\{\hyperlink{fullpage_2plugin_8min_8js_ac56c57897e10f699d124e0103921aa20}{value}+= 'px';\}return \hyperlink{fullpage_2plugin_8min_8js_ac56c57897e10f699d124e0103921aa20}{value};\}var \hyperlink{fullpage_2plugin_8js_a718c1bf5a3bf21ebb980203b142e5b75}{data}=win.\+to\+J\+S\+O\+N();var \hyperlink{extras_2_scroller_2media_2docs_2media_2js_2jquery_8js_a7f3289748d8b48665399d82540f341dd}{css}=dom.\+parse\+Style(data.\+style);delete css.\+margin;\hyperlink{extras_2_scroller_2media_2docs_2media_2js_2jquery_8js_a7f3289748d8b48665399d82540f341dd}{css}\mbox{[}'margin-\/top'\mbox{]}=\hyperlink{extras_2_scroller_2media_2docs_2media_2js_2jquery_8js_a7f3289748d8b48665399d82540f341dd}{css}\mbox{[}'margin-\/bottom'\mbox{]}=add\+Pixel\+Suffix(data.\+vspace);\hyperlink{extras_2_scroller_2media_2docs_2media_2js_2jquery_8js_a7f3289748d8b48665399d82540f341dd}{css}\mbox{[}'margin-\/left'\mbox{]}=\hyperlink{extras_2_scroller_2media_2docs_2media_2js_2jquery_8js_a7f3289748d8b48665399d82540f341dd}{css}\mbox{[}'margin-\/right'\mbox{]}=add\+Pixel\+Suffix(data.\+hspace);\hyperlink{extras_2_scroller_2media_2docs_2media_2js_2jquery_8js_a7f3289748d8b48665399d82540f341dd}{css}\mbox{[}'border-\/width'\mbox{]}=add\+Pixel\+Suffix(data.\+border);win.\+find('\#style').\hyperlink{fullpage_2plugin_8min_8js_ac56c57897e10f699d124e0103921aa20}{value}(dom.\+serialize\+Style(dom.\+parse\+Style(dom.\+serialize\+Style(\hyperlink{extras_2_scroller_2media_2docs_2media_2js_2jquery_8js_a7f3289748d8b48665399d82540f341dd}{css}))));\}\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(editor.\+settings.\+image\+\_\+advtab)\{\hyperlink{fullpage_2plugin_8js_a8b98017e64ef036adb9ae327ff94abe1}{if}(img\+Elm)\{data.\+hspace=remove\+Pixel\+Suffix(img\+Elm.\+style.\+margin\+Left$\vert$$\vert$img\+Elm.\+style.\+margin\+Right);data.\+vspace=remove\+Pixel\+Suffix(img\+Elm.\+style.\+margin\+Top$\vert$$\vert$img\+Elm.\+style.\+margin\+Bottom);data.\+border=remove\+Pixel\+Suffix(img\+Elm.\+style.\+border\+Width);data.\+style=editor.\+dom.\+serialize\+Style(editor.\+dom.\+parse\+Style(editor.\+dom.\+get\+Attrib(img\+Elm, 'style')));\}win=editor.\+window\+Manager.\+open(\{title\+: 'Insert/edit image', data\+:data, body\+Type\+: 'tabpanel', body\+:\mbox{[}\{title\+: 'General', type\+: 'form', items\+:general\+Form\+Items\},\{title\+: 'Advanced', type\+: 'form', pack\+: '\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start}', items\+:\mbox{[}\{label\+: '\hyperlink{_zero_clipboard_pdf_8as_af22c559e56786a0e69bbeb3b56ce1ae3}{Style}', name\+: 'style', type\+: 'textbox'\},\{type\+: 'form', layout\+: 'grid', pack\+V\+: '\hyperlink{jquery-1_89_81_8js_aef10902ffededd983608fdb8dbfc441a}{start}', columns\+:2, padding\+:0, align\+H\+:\mbox{[}'left', 'right'\mbox{]}, defaults\+:\{type\+: 'textbox', max\+Width\+:50, onchange\+:update\+Style\}, items\+:\mbox{[}\{label\+: 'Vertical space', name\+: 'vspace'\},\{label\+: 'Horizontal space', name\+: 'hspace'\},\{label\+: 'Border', name\+: 'border'\}\mbox{]}\}\mbox{]}\}\mbox{]}, on\+Submit\+:on\+Submit\+Form\});\}\hyperlink{jquery_8iframe-transport_8js_a0544c3fe466e421738dae463968b70ba}{else}\{win=editor.\+window\+Manager.\+open(\{title\+: 'Insert/edit image', data\+:data, body\+:general\+Form\+Items, on\+Submit\+:on\+Submit\+Form\});\}\}\hyperlink{fullpage_2plugin_8min_8js_aaae28359b3a3a6d0ae04231039eb7f9e}{editor.\+add\+Button}('image',\{icon\+: 'image', tooltip\+: 'Insert/edit image', onclick\+:create\+Image\+List(show\+Dialog), state\+Selector\+: 'img\+:not(\mbox{[}\hyperlink{fullpage_2plugin_8js_a718c1bf5a3bf21ebb980203b142e5b75}{data}-\/mce-\/object\mbox{]})'\});\hyperlink{fullpage_2plugin_8min_8js_a0f87fa0589e24d2778208f3e61ea1a10}{editor.\+add\+Menu\+Item}('image',\{icon\+: 'image', text\+: 'Insert image', onclick\+:create\+Image\+List(show\+Dialog), context\+: 'insert', prepend\+To\+Context\+:true\});\})
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{image_2plugin_8js_ab6d48e73e4597401d510253ac0b2c8ca}{\index{image/plugin.\+js@{image/plugin.\+js}!add@{add}}
\index{add@{add}!image/plugin.\+js@{image/plugin.\+js}}
\subsubsection[{add}]{\setlength{\rightskip}{0pt plus 5cm}{\bf tinymce} Plugin\+Manager add (
\begin{DoxyParamCaption}
\item[{'image'}]{, }
\item[{function(editor)\{function get\+Image\+Size(url, callback)\{var img=document.\+create\+Element('img');function done(width, {\bf height})\{{\bf img.\+parent\+Node.\+remove\+Child}(img);callback(\{width\+:width, height\+:height\});\}img.\+onload=function()\{done(img.\+client\+Width, img.\+client\+Height);\};img.\+onerror=function()\{done();\};img.\+src=url;var style=img.\+style;style.\+visibility= '{\bf hidden}';{\bf style.\+position}= 'fixed';style.\+bottom=style.\+left=0;style.\+width={\bf style.\+height}= 'auto';{\bf document.\+body.\+append\+Child}(img);\}function create\+Image\+List(callback)\{return function()\{var image\+List=editor.\+settings.\+image\+\_\+list;{\bf if}({\bf typeof}(image\+List)==\char`\"{}string\char`\"{})\{tinymce.\+util.\+X\+H\+R.\+send(\{url\+:image\+List, success\+:function(text)\{callback(tinymce.\+util.\+J\+S\+O\+N.\+parse(text));\}\});\}{\bf else}\{callback(image\+List);\}\};\}function show\+Dialog(image\+List)\{var win, {\bf data}=\{\}, dom=editor.\+dom, img\+Elm=editor.\+selection.\+get\+Node();var width, {\bf height}, image\+List\+Ctrl;function build\+Image\+List()\{var image\+List\+Items=\mbox{[}\{text\+: 'None', value\+: ''\}\mbox{]};{\bf tinymce.\+each}(image\+List, function(image)\{{\bf image\+List\+Items.\+push}(\{text\+:image.\+text$\vert$$\vert${\bf image.\+title}, value\+:editor.\+convert\+U\+R\+L({\bf image.\+value}$\vert$$\vert$image.\+url, 'src'), menu\+:image.\+menu\});\});return image\+List\+Items;\}function recalc\+Size({\bf e})\{var width\+Ctrl, height\+Ctrl, new\+Width, new\+Height;width\+Ctrl=win.\+find('\#width')\mbox{[}0\mbox{]};height\+Ctrl=win.\+find('\#{\bf height}')\mbox{[}0\mbox{]};new\+Width={\bf width\+Ctrl.\+value}();new\+Height={\bf height\+Ctrl.\+value}();{\bf if}(win.\+find('\#constrain')\mbox{[}0\mbox{]}.checked()\&\&width \&\&{\bf height} \&\&new\+Width \&\&new\+Height)\{{\bf if}(e.\+control==width\+Ctrl)\{new\+Height={\bf Math.\+round}((new\+Width/width)$\ast$new\+Height);{\bf height\+Ctrl.\+value}(new\+Height);\}{\bf else}\{new\+Width={\bf Math.\+round}((new\+Height/{\bf height})$\ast$new\+Width);{\bf width\+Ctrl.\+value}(new\+Width);\}\}width=new\+Width;{\bf height}=new\+Height;\}function on\+Submit\+Form()\{function wait\+Load(img\+Elm)\{function select\+Image()\{img\+Elm.\+onload=img\+Elm.\+onerror={\bf null};{\bf editor.\+selection.\+select}(img\+Elm);editor.\+node\+Changed();\}img\+Elm.\+onload=function()\{{\bf if}(!data.\+width \&\&!{\bf data.\+height})\{{\bf dom.\+set\+Attribs}(img\+Elm,\{width\+:img\+Elm.\+client\+Width, height\+:img\+Elm.\+client\+Height\});\}select\+Image();\};img\+Elm.\+onerror=select\+Image;\}var {\bf data}=win.\+to\+J\+S\+O\+N();{\bf if}(data.\+width=== '')\{data.\+width={\bf null};\}{\bf if}({\bf data.\+height}=== '')\{{\bf data.\+height}={\bf null};\}{\bf if}(data.\+style=== '')\{data.\+style={\bf null};\}{\bf data}=\{src\+:data.\+src, alt\+:data.\+alt, width\+:data.\+width, {\bf height\+:data.\+height}, style\+:data.\+style\};editor.\+undo\+Manager.\+transact(function()\{{\bf if}(!data.\+src)\{{\bf if}(img\+Elm)\{{\bf dom.\+remove}(img\+Elm);editor.\+node\+Changed();\}return;\}{\bf if}(!img\+Elm)\{data.\+id= '\+\_\+\+\_\+mcenew';{\bf editor.\+selection.\+set\+Content}(dom.\+create\+H\+T\+M\+L('img', {\bf data}));img\+Elm=dom.\+get('\+\_\+\+\_\+mcenew');dom.\+set\+Attrib(img\+Elm, 'id', {\bf null});\}{\bf else}\{{\bf dom.\+set\+Attribs}(img\+Elm, {\bf data});\}wait\+Load(img\+Elm);\});\}function remove\+Pixel\+Suffix({\bf value})\{{\bf if}({\bf value})\{{\bf value}=value.\+replace(/px \$/, '');\}return {\bf value};\}function src\+Change()\{{\bf if}(image\+List\+Ctrl)\{{\bf image\+List\+Ctrl.\+value}(editor.\+convert\+U\+R\+L({\bf this.\+value}(), 'src'));\}get\+Image\+Size({\bf this.\+value}(), function({\bf data})\{{\bf if}(data.\+width \&\&{\bf data.\+height})\{width=data.\+width;{\bf height}={\bf data.\+height};win.\+find('\#width').{\bf value}(width);win.\+find('\#{\bf height}').{\bf value}({\bf height});\}\});\}width=dom.\+get\+Attrib(img\+Elm, 'width');{\bf height}=dom.\+get\+Attrib(img\+Elm, '{\bf height}');{\bf if}(img\+Elm.\+node\+Name== 'I\+M\+G'\&\&!img\+Elm.\+get\+Attribute('{\bf data}-\/mce-\/object'))\{{\bf data}=\{src\+:dom.\+get\+Attrib(img\+Elm, 'src'), alt\+:dom.\+get\+Attrib(img\+Elm, 'alt'), width\+:width, height\+:height\};\}{\bf else}\{img\+Elm={\bf null};\}{\bf if}(image\+List)\{image\+List\+Ctrl=\{type\+: 'listbox', label\+: 'Image list', values\+:build\+Image\+List(), value\+:data.\+src \&\&editor.\+convert\+U\+R\+L(data.\+src, 'src'), onselect\+:function({\bf e})\{var alt\+Ctrl=win.\+find('\#alt');{\bf if}(!{\bf alt\+Ctrl.\+value}()$\vert$$\vert$(e.\+last\+Control \&\&{\bf alt\+Ctrl.\+value}()==e.\+last\+Control.\+text()))\{{\bf alt\+Ctrl.\+value}(e.\+control.\+text());\}win.\+find('\#src').{\bf value}({\bf e.\+control.\+value}());\}, on\+Post\+Render\+:function()\{image\+List\+Ctrl={\bf this};\}\};\}var general\+Form\+Items=\mbox{[}\{name\+: 'src', type\+: 'filepicker', filetype\+: 'image', label\+: 'Source', autofocus\+:true, onchange\+:src\+Change\}, image\+List\+Ctrl,\{name\+: 'alt', type\+: 'textbox', label\+: 'Image description'\},\{type\+: 'container', label\+: 'Dimensions', layout\+: 'flex', direction\+: 'row', align\+: 'center', spacing\+:5, items\+:\mbox{[}\{name\+: 'width', type\+: 'textbox', max\+Length\+:3, size\+:3, onchange\+:recalc\+Size\},\{type\+: 'label', text\+: 'x'\},\{name\+: '{\bf height}', type\+: 'textbox', max\+Length\+:3, size\+:3, onchange\+:recalc\+Size\},\{name\+: 'constrain', type\+: 'checkbox', checked\+:true, text\+: 'Constrain proportions'\}\mbox{]}\}\mbox{]};function update\+Style()\{function add\+Pixel\+Suffix({\bf value})\{{\bf if}(value.\+length $>$ 0 \&\&/$^\wedge$\mbox{[}0-\/9\mbox{]}+\$/.test({\bf value}))\{{\bf value}+= 'px';\}return {\bf value};\}var {\bf data}=win.\+to\+J\+S\+O\+N();var {\bf css}=dom.\+parse\+Style(data.\+style);delete css.\+margin;{\bf css}\mbox{[}'margin-\/top'\mbox{]}={\bf css}\mbox{[}'margin-\/bottom'\mbox{]}=add\+Pixel\+Suffix(data.\+vspace);{\bf css}\mbox{[}'margin-\/left'\mbox{]}={\bf css}\mbox{[}'margin-\/right'\mbox{]}=add\+Pixel\+Suffix(data.\+hspace);{\bf css}\mbox{[}'border-\/width'\mbox{]}=add\+Pixel\+Suffix(data.\+border);win.\+find('\#style').{\bf value}(dom.\+serialize\+Style(dom.\+parse\+Style(dom.\+serialize\+Style({\bf css}))));\}{\bf if}(editor.\+settings.\+image\+\_\+advtab)\{{\bf if}(img\+Elm)\{data.\+hspace=remove\+Pixel\+Suffix(img\+Elm.\+style.\+margin\+Left$\vert$$\vert$img\+Elm.\+style.\+margin\+Right);data.\+vspace=remove\+Pixel\+Suffix(img\+Elm.\+style.\+margin\+Top$\vert$$\vert$img\+Elm.\+style.\+margin\+Bottom);data.\+border=remove\+Pixel\+Suffix(img\+Elm.\+style.\+border\+Width);data.\+style=editor.\+dom.\+serialize\+Style(editor.\+dom.\+parse\+Style(editor.\+dom.\+get\+Attrib(img\+Elm, 'style')));\}win=editor.\+window\+Manager.\+open(\{title\+: 'Insert/edit image', data\+:data, body\+Type\+: 'tabpanel', body\+:\mbox{[}\{title\+: 'General', type\+: 'form', items\+:general\+Form\+Items\},\{title\+: 'Advanced', type\+: 'form', pack\+: '{\bf start}', items\+:\mbox{[}\{label\+: '{\bf Style}', name\+: 'style', type\+: 'textbox'\},\{type\+: 'form', layout\+: 'grid', pack\+V\+: '{\bf start}', columns\+:2, padding\+:0, align\+H\+:\mbox{[}'left', 'right'\mbox{]}, defaults\+:\{type\+: 'textbox', max\+Width\+:50, onchange\+:update\+Style\}, items\+:\mbox{[}\{label\+: 'Vertical space', name\+: 'vspace'\},\{label\+: 'Horizontal space', name\+: 'hspace'\},\{label\+: 'Border', name\+: 'border'\}\mbox{]}\}\mbox{]}\}\mbox{]}, on\+Submit\+:on\+Submit\+Form\});\}{\bf else}\{win=editor.\+window\+Manager.\+open(\{title\+: 'Insert/edit image', data\+:data, body\+:general\+Form\+Items, on\+Submit\+:on\+Submit\+Form\});\}\}{\bf editor.\+add\+Button}('image',\{icon\+: 'image', tooltip\+: 'Insert/edit image', onclick\+:create\+Image\+List(show\+Dialog), state\+Selector\+: 'img\+:not(\mbox{[}{\bf data}-\/mce-\/object\mbox{]})'\});{\bf editor.\+add\+Menu\+Item}('image',\{icon\+: 'image', text\+: 'Insert image', onclick\+:create\+Image\+List(show\+Dialog), context\+: 'insert', prepend\+To\+Context\+:true\});\}}]{}
\end{DoxyParamCaption}
)}}\label{image_2plugin_8js_ab6d48e73e4597401d510253ac0b2c8ca}
plugin.\+js

Copyright, Moxiecode Systems A\+B Released under L\+G\+P\+L License.

License\+: \href{http://www.tinymce.com/license}{\tt http\+://www.\+tinymce.\+com/license} Contributing\+: \href{http://www.tinymce.com/contributing}{\tt http\+://www.\+tinymce.\+com/contributing} 